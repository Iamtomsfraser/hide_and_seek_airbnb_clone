

<% user_id = current_user.id %>
<% flat_id = @flat.id %>
<% booking = Booking.where(user_id: user_id, flat_id: flat_id) %>

<div class="container-reviews">
<% if  booking.present? %>
  <h2>Write a Review</h2>
 <div>
  <%= simple_form_for([@flat, @review]) do |f| %>
  <%= f.input :title %>
  <%= f.input :rating %>
  <%= f.input :comment %>
  <%= f.submit %>
<% end %>
</div>
<% end %>

<div class='mt-2'>
  <h4>Reviews:</h4>
  <% if @flat.reviews.any? %>
      <% last_review = @flat.reviews.last %>
      <% @flat.reviews.each do |review| %>
          <% border = review == last_review ? "" : "border-bottom" %>
        <div class="review-item d-flex justify-content-between <%= 'border' unless review == last_review %>">
          <div>
          <h5><%= review.title %>       <%= ("⭐️" * review.rating) + "☆" * (5 - review.rating) %></h5>
          <p></p>
            <p> <%= review.comment %></p>
          <span class="review-email">Created by: <%= review.user.email %><span>
          </div>
            <div class="delete-button mt-7 ml-10">
        <% if review.user = current_user %>
          <%= link_to "Delete", flat_review_path(@flat, review), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: "btn btn-danger" %>
          <% end %>
          </div>
        </div>

    <% end %>
  <% else %>
      <div class="no-reviews">
        <p>No reviews yet!</p>
        <p>Be the first to share your experience.</p>
      </div>
<% end %>
</div>
</div>
